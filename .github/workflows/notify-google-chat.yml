name: Notify

on:
  pull_request:
    types: [opened, reopened, closed]
  pull_request_review_comment:
    types: [created]
  workflow_dispatch: # Añadido para ejecución manual

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Debug Workflow Trigger
        run: |
          echo "Event Name: $GITHUB_EVENT_NAME"
          echo "Actor: $GITHUB_ACTOR"
          echo "Repository: $GITHUB_REPOSITORY"
          echo "Ref: $GITHUB_REF"
          echo "Base Ref: ${{ github.event.pull_request.base.ref || 'N/A' }}"
          echo "Head Ref: ${{ github.event.pull_request.head.ref || 'N/A' }}"
          echo "Event Path Content: $(cat $GITHUB_EVENT_PATH || echo 'File not found')"
      - name: Google Chat Notification
        uses: CommonMarvel/google-chat-notification@v2
        with:
          url: ${{ secrets.GOOGLE_CHAT_WEBHOOK_URL }}
        if: always() # Asegura que se ejecute incluso si falla un paso previo