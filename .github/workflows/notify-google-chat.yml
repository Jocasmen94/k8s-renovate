name: PR Notification

on:
  pull_request:
    types: [opened]
    branches:
      - feat/n1-prod-payments-k8s
      - feat/prod-main-test

jobs:
  notify-pr:
    runs-on: ubuntu-latest
    if: startsWith(github.event.pull_request.head.ref, 'renovate/')
    steps:
      - name: Debug Workflow Trigger
        run: |
          echo "Event Name: $GITHUB_EVENT_NAME"
          echo "Actor: $GITHUB_ACTOR"
          echo "Repository: $GITHUB_REPOSITORY"
          echo "PR Title: ${{ github.event.pull_request.title }}"
          echo "PR URL: ${{ github.event.pull_request.html_url }}"
          echo "Head Ref: ${{ github.event.pull_request.head.ref }}"
          echo "Base Ref: ${{ github.event.pull_request.base.ref }}"

      - name: Google Chat PR Notification
        if: always()
        uses: SimonScholz/google-chat-action@main
        with:
          webhookUrl: ${{ secrets.GOOGLE_CHAT_WEBHOOK_URL }}
          jobStatus: ${{ job.status }}
          title: "New PR Opened"
          subtitle: "PR #${{ github.event.pull_request.number }} - ${{ github.event.pull_request.title }}"
          threadKey: ${{ github.event.number }}